window.webcam={version:"shearphoto2.3",ie:!!navigator.userAgent.match(/MSIE/),protocol:location.protocol.match(/https/i)?"https":"http",callback:null,swf_url:"images/webcam.swf",shutter_url:"images/shutter.mp3",api_url:"",loaded:!1,quality:90,shutter_sound:!0,stealth:!0,hooks:{onLoad:null,onAllow:null,onComplete:null,onError:null},set_hook:function(a,b){return"undefined"==typeof this.hooks[a]?alert("Hook type not supported: "+a):(this.hooks[a]=b,void 0)},fire_hook:function(a,b){return this.hooks[a]?("function"==typeof this.hooks[a]?this.hooks[a](b):"array"==typeof this.hooks[a]?this.hooks[a][0][this.hooks[a][1]](b):window[this.hooks[a]]&&window[this.hooks[a]](b),!0):!1},set_api_url:function(a){this.api_url=a},set_swf_url:function(a){this.swf_url=a},configure:function(){this.get_movie()._configure("camera")},get_html:function(){var a="",b=this.init_config.server_width,c=this.init_config.server_height,d="shutter_enabled="+(this.shutter_sound?1:0)+"&shutter_url="+escape(this.shutter_url)+"&width="+this.init_config.width+"&height="+this.init_config.height+"&server_width="+b+"&server_height="+c+"&uploadfield="+this.init_config.uploadfield;return a+=this.ie?'<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+this.protocol+'://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+b+'" height="'+c+'" id="webcam_movie" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+this.swf_url+"?bugid="+Math.random()+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+d+'"/><param name="wmode" value="opaque"/></object>':'<embed id="webcam_movie" src="'+this.swf_url+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+b+'" height="'+c+'" name="webcam_movie" align="middle" allowScriptAccess="always" wmode="opaque" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+d+'" />',this.loaded=!1,a},get_movie:function(){if(!this.loaded)return this.noCamcall();var a=document.getElementById("webcam_movie");return a||alert("ERROR: Cannot locate movie 'webcam_movie' in DOM"),a},set_stealth:function(a){this.stealth=a},Homing:function(a){clearInterval(this.timer),this.timer=null,a.style.display="none"},timingfun:function(a,b,c,d){var e,f,g;return this.CamTrue?(c.innerHTML="取消",e=3,f=this,g=arguments,c.onclick=function(){f.Homing(a),c.innerHTML="拍照",c.onclick=function(){f.timingfun.apply(f,g)}},a.style.display="block",a.innerHTML=e,this.timer=setInterval(function(){return e--,0===e?(f.Homing(a),d.call(f),c.innerHTML="处理中...",c.onclick=null,void 0):(a.innerHTML=e,void 0)},800),void 0):(alert("请问：你敢允许摄像头启动吗"),!1)},newsnap:function(a,b,c){this.CamTrue=!1;var d=this;c.innerHTML="拍照",c.onclick=function(){d.timingfun(a,b,c,d.snap)}},snap:function(a,b,c){b&&this.set_hook("onComplete",b),a&&this.set_api_url(a),"undefined"!=typeof c&&this.set_stealth(c);var d=this.get_movie();this.init_config.postargs&&d.SetPostParams(this.init_config.postargs),d._snap(this.api_url,this.quality,this.shutter_sound?1:0,this.stealth?1:0)},freeze:function(){this.get_movie()._snap("",this.quality,this.shutter_sound?1:0,0)},upload:function(a,b){b&&this.set_hook("onComplete",b),a&&this.set_api_url(a),this.get_movie()._upload(this.api_url)},reset:function(){this.get_movie()._reset()},configure:function(a){a||(a="camera"),this.get_movie()._configure(a)},set_quality:function(a){this.quality=a},set_shutter_sound:function(a,b){this.shutter_sound=a,this.shutter_url=b?b:"images/shutter.mp3"},flash_notify:function(a,b){switch(a){case"security":if("Camera.Muted"===b)return this.noCamcall("你已拒绝了摄像头启动！"),void 0;this.CamTrue="Camera.Unmuted"===b,this.fire_hook("onAllow",this.CamTrue);break;case"flashLoadComplete":this.loaded=!0,this.fire_hook("onLoad");break;case"error":this.fire_hook("onError",b)||this.noCamcall("没检测到摄像头启动，拍照失败,检查是否其他程序占用了摄象头");break;case"success":this.fire_hook("onComplete",b.toString());break;default:alert("flash_notify: "+a+": "+b)}}};